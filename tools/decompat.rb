#!/usr/bin/env ruby
## Copyright © 2017 Alison Sanderson, all rights reserved.
## DeCompat: ZScript ↔ C shared syntax preprocessor.

def writehead out
   out.write "// This file was generated by decompat.\n"
   out.write "// Edit only if you aren't going to recompile.\n\n"
end

def tozsc fp, out
   writehead out

   for ln in fp
      out.write ln.chomp.sub(/enum \/\/ /, "enum ") + "\n"
   end
end

for arg in ARGV
   fp = open(arg, "rt")
   zsc = fp.gets[15..-1].chomp
   fp.gets
   tozsc fp, open(zsc, "wt")
end

## EOF
